// BraidsbyEva.com - Database Schema
// Professional braiding appointment booking system

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id          String   @id @default(cuid())
  email       String   @unique
  firstName   String
  lastName    String
  phone       String?
  hairType    String?
  hairLength  String?
  preferences Json?
  isAdmin     Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  appointments Appointment[]
  reviews     Review[]
  
  @@map("users")
}

model Service {
  id          String   @id @default(cuid())
  name        String
  description String
  duration    Int      // in minutes
  basePrice   Float
  category    String
  isActive    Boolean  @default(true)
  imageUrl    String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  appointments Appointment[]
  
  @@map("services")
}

model Appointment {
  id             String   @id @default(cuid())
  userId         String
  serviceId      String
  appointmentDate DateTime
  status         AppointmentStatus @default(SCHEDULED)
  totalPrice     Float
  paymentMethod  PaymentMethod
  paymentStatus  PaymentStatus @default(PENDING)
  stripePaymentId String?
  notes          String?
  specialRequests String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  service        Service  @relation(fields: [serviceId], references: [id])
  
  @@map("appointments")
}

model Availability {
  id          String @id @default(cuid())
  dayOfWeek   Int    // 0-6 (Sunday-Saturday)
  startTime   String // "09:00"
  endTime     String // "17:00"
  isAvailable Boolean @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@map("availability")
}

model Review {
  id        String   @id @default(cuid())
  userId    String
  rating    Int      // 1-5 stars
  comment   String?
  isVisible Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("reviews")
}

model Gallery {
  id          String   @id @default(cuid())
  title       String
  description String?
  imageUrl    String
  category    String
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@map("gallery")
}

model ContactMessage {
  id        String   @id @default(cuid())
  name      String
  email     String
  phone     String?
  subject   String
  message   String
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  
  @@map("contact_messages")
}

enum AppointmentStatus {
  SCHEDULED
  CONFIRMED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  NO_SHOW
}

enum PaymentMethod {
  CARD
  ZELLE
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
}
